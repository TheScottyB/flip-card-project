function initFlipCards(){document.querySelectorAll(".flip-card").forEach((e,t)=>{const n=`flip-card-${t}`,c=`${n}-front`,i=`${n}-back`,r=e.querySelector(".flip-card-front"),s=e.querySelector(".flip-card-back");r.id=c,s.id=i;const a=r.querySelector(".flip-trigger"),o=s.querySelector(".flip-trigger");a&&(a.setAttribute("aria-controls",i),a.setAttribute("aria-expanded","false"),a.setAttribute("aria-pressed","false"),a.addEventListener("click",t=>{t.preventDefault(),flipCard(e,!0)})),o&&(o.setAttribute("aria-controls",c),o.setAttribute("aria-expanded","true"),o.setAttribute("aria-pressed","true"),o.addEventListener("click",t=>{t.preventDefault(),flipCard(e,!1)})),e.setAttribute("tabindex","0"),e.addEventListener("keydown",t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),flipCard(e,!e.classList.contains("flipped"))),"Escape"===t.key&&e.classList.contains("flipped")&&(t.preventDefault(),flipCard(e,!1))}),window.matchMedia("(hover: none)").matches&&e.addEventListener("click",t=>{if(!t.target.closest("button, a")){const n=e.classList.toggle("flipped"),c=this.querySelector("h3")?.textContent.trim()||"Card";this.querySelectorAll(".flip-trigger").forEach(e=>{e.setAttribute("aria-pressed",n),e.setAttribute("aria-expanded",n)}),n&&setTimeout(()=>{const t=this.querySelector(".flip-card-back .flip-trigger");t&&t.focus()},100);const i=document.getElementById("card-status");i.textContent=n?`${c} card flipped to back side showing office information`:`${c} card flipped to front side showing contact information`}}),setupFocusTrap(e,s)})}function flipCard(e,t){const n=e.querySelector("h2")?.textContent.trim()||"Card";t?e.classList.add("flipped"):e.classList.remove("flipped");const c=e.querySelector(".flip-card-front .flip-trigger"),i=e.querySelector(".flip-card-back .flip-trigger");c&&(c.setAttribute("aria-expanded",t.toString()),c.setAttribute("aria-pressed",t.toString())),i&&(i.setAttribute("aria-expanded",(!t).toString()),i.setAttribute("aria-pressed",(!t).toString())),setTimeout(()=>{if(t){const t=getFirstFocusableElement(e.querySelector(".flip-card-back"));t&&t.focus()}else{const t=getFirstFocusableElement(e.querySelector(".flip-card-front"));t&&t.focus()}},100),announceToScreenReader(t?`${n} card flipped to back side`:`${n} card flipped to front side`)}function getFirstFocusableElement(e){const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');return t.length>0?t[0]:null}function setupFocusTrap(e,t){t.addEventListener("keydown",function(n){if(!e.classList.contains("flipped"))return;const c=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),i=c[0],r=c[c.length-1];"Tab"===n.key&&(n.shiftKey&&document.activeElement===i?(n.preventDefault(),r.focus()):n.shiftKey||document.activeElement!==r||(n.preventDefault(),i.focus()))})}function announceToScreenReader(e){let t=document.getElementById("screen-reader-announcer");t||(t=document.createElement("div"),t.id="screen-reader-announcer",t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",document.body.appendChild(t)),t.textContent=e}document.addEventListener("DOMContentLoaded",initFlipCards),window.MutationObserver&&new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.length&&initFlipCards()})}).observe(document.body,{childList:!0,subtree:!0});